{%- raw -%}
  {%- comment -%} If this item has children and is on the top level, output the item, and then go get its children. This layout does not support multi-levels. {%- endcomment -%}
  {%- if this['is_parent'] and _level == 1 -%}
    <li>
      <div>
        <button id="dropdown_{{sitegurus_ui_uniq_component_id}}_{{_level}}_{{forloop.index}}" data-dropdown-toggle="{{sitegurus_ui_uniq_component_id}}_{{_level}}_{{forloop.index}}" class="flex justify-between items-center py-2 pr-4 pl-3 w-full font-medium text-gray-700 border-b border-gray-100 lg:w-auto hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-primary-600 lg:p-0 dark:text-gray-400 lg:dark:hover:text-primary-500 dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" type="button">{{this['link_name']}} <svg class="w-4 h-4 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button>
        <div id="{{sitegurus_ui_uniq_component_id}}_{{_level}}_{{forloop.index}}" class="grid hidden absolute z-10 w-full bg-white border border-gray-100 shadow-md dark:border-gray-700 lg:rounded-lg lg:w-auto lg:grid-cols-3 dark:bg-gray-700" aria-labelledby="dropdown_{{sitegurus_ui_uniq_component_id}}_{{_level}}_{{forloop.index}}">
          <div class="p-2 text-gray-900 bg-white lg:rounded-lg dark:text-white lg:col-span-2 dark:bg-gray-800">
            <ul>
              {%- assign _next_level = _level | plus: 1 -%}
              {%- include 'modules/siteglide_menu/get/get_items', level: _next_level, parent_id: this['forced_id'], item_layout: 'item' -%}
            </ul>
          </div>
          <div class="py-5 px-5 bg-gray-50 lg:rounded-lg lg:col-span-1 dark:bg-gray-700">
            <h3 class="mb-4 text-sm font-semibold text-gray-900 dark:text-white">Browse categories</h3>
            <ul class="space-y-4 text-sm text-gray-500 dark:text-gray-400">
              {% for category in context.exports.categories.data %}
                {% if category[1].parent == blank %}
                  <li>
                    <a href="{{category[1].full_slug}}" class="{% if category[1].full_slug == context.location.pathname %}text-primary-600 text-primary-500 {% else %}hover:text-primary-600 dark:hover:text-primary-500{% endif %}">{{category[1].name}}</a>
                  </li>
                {% endif %}
              {% endfor %}
            </ul>
          </div>
        </div>
      </div>
    </li>
  {%- else -%}
    {%- comment -%} Else output dropdown children or single item {%- endcomment -%}
    <li {% if this['link_url'] == context.location.pathname %}aria-current="page"{% endif %} class="{% if _level == 1 %}lg:flex lg:items-center{% endif %}">
      <a class="{% if this['link_url'] == context.location.pathname and _level == 1 %}
        {% comment %} Top level current link {% endcomment %}
        block py-2 pr-4 pl-3 border-b border-gray-100 text-primary-600 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-primary-600 lg:p-0 dark:text-primary-500 lg:dark:hover:text-primary-500 dark:hover:bg-gray-700 dark:hover:text-primary-500 lg:dark:hover:bg-transparent dark:border-gray-700
      {% elsif _level == 1 %}
        {% comment %} Top level standard link {% endcomment %}
        block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-primary-600 lg:p-0 dark:text-gray-400 lg:dark:hover:text-primary-500 dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700
      {% elsif this['link_url'] == context.location.pathname and _level > 1 %}
        {% comment %} Nested current link {% endcomment %}
        flex items-center p-3 rounded-lg bg-gray-50 dark:bg-gray-700
      {% elsif _level > 1 %}
        {% comment %} Nested standard link {% endcomment %}
        flex items-center p-3 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700
      {% endif %}" {% if this['link_target'] %} target="{{this['link_target']}}"{% endif %} href="{{this['link_url']}}">
        {% if _level > 1 %}
          <div class="p-2 mr-4 bg-white rounded-lg shadow dark:bg-gray-700">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" />
            </svg>
          </div>
          <div>
            <div class="font-semibold">{{this['link_name']}}</div>
            {% comment %} <div class="text-sm font-light text-gray-500 dark:text-gray-400"></div> {% endcomment %}
          </div>
        {% else %}
          {{this['link_name']}}
        {% endif %}
      </a>
    </li>
  {%- endif -%}
{%- endraw -%}